<<<<<<< HEAD
var state="welcome",user="",currentTimezone=(new Date).getTimezoneOffset()/60*-1,currTimezString="GMT"+(0>currentTimezone?"-":"+")+("0"+Math.floor(Math.abs(currentTimezone))).slice(-2)+("0"+60*(Math.abs(currentTimezone)-Math.floor(Math.abs(currentTimezone)))).slice(-2),listViewDay=0,isaa,events=[],cm=0,cy=0,viewstate,rn=0,lwr=0,fwr=0,oss=0,currentDatetime=new Date,currentDaytime,goheight,gowidth,gooffsettop,gooffsetleft;currentDaytime=currentDatetime.getHours()<6?0:currentDatetime.getHours()<10?1:currentDatetime.getHours()<17?2:currentDatetime.getHours()<22?3:0,$(document).ready(function(){function e(e,t,i,a){$("#fullscreen").append('<div id="'+t+'" style="background-color:'+a+"; z-index:"+(parseInt($("#"+e).css("z-index"))-1)+'"><h1 style="opacity:0; margin-left:50%">'+i+"</h1></div>"),$("#fullscreen #"+e).css({opacity:"0"}),$("#fullscreen #"+e+" h1").css({"margin-left":"-50%",opacity:"0"}),setTimeout(function(){$("#fullscreen #"+t+" h1").css({"margin-left":"0%",opacity:"1"}),setTimeout(function(){$("#fullscreen #"+e).css("display","none")},1e3)},100)}function t(e,t,i,a,n){$("body").css("background-color",n),$("#"+e).css({height:t+"%","background-color":a}),setTimeout(function(){$("#"+e).css("display","none"),$("#outer_fullscreen").append('<div id="outer_'+e+'" style="background-color:'+a+"; height:"+t+"%; top:"+(100-t-i)+'%">'+$("#"+e).html()+"</div>"),$("#fullscreen").css({height:i+"%",top:100-i+"%"})},1100)}function a(e,t,i){$("#fullscreen").html('<div id="'+e+'" style="background-color:'+i+'"><h1>'+t+"</h1></div>"),$("#outer_fullscreen").html(""),$("#fullscreen, #outer_fullscreen").removeAttr("style")}function n(){"0px"==$("#calendar_wrapper").css("margin-top")?$("#calendar_wrapper").css("margin-top","-150%"):(state="calendar",$("#calendar_wrapper").css("margin-top","0px"))}function s(){"0px"==$("#calendar_wrapper #headline #settings #content").css("width")?($("#calendar_wrapper #headline #settings #content").css({padding:"0.125em 0.5em",width:"90%"}),$("#calendar_wrapper #headline #text").css("opacity","0"),setTimeout(function(){$("#calendar_wrapper #headline #text").css({width:"0px","margin-left":"-200%"})},1e3)):($("#calendar_wrapper #headline #text").css({width:"auto","margin-left":"0"}),$("#calendar_wrapper #headline #settings #content").css({padding:"0.125em 0em",width:"0px"}),$("#calendar_wrapper #headline #text").css("opacity","1"))}function o(){"true"==$.cookie("overview")?($.cookie("overview","false"),$("#calendar_wrapper #headline #settings #content #overview").attr("src","img/checkbox_unchecked.svg")):($.cookie("overview","true"),$("#calendar_wrapper #headline #settings #content #overview").attr("src","img/checkbox_checked.svg"))}function l(){void 0==$.cookie("user")?($.cookie("user",user),$("#calendar_wrapper #headline #settings #content #loggedin").attr("src","img/checkbox_checked.svg")):($.removeCookie("user"),$("#calendar_wrapper #headline #settings #content #loggedin").attr("src","img/checkbox_unchecked.svg"))}function p(){"0px"==$("#views").css("margin-top")?($("#views").css("margin-top","150%"),viewstate=3):(viewstate=0,$("#views #container > div").remove(),H(cm,cy),$("#views").css("margin-top","0px"))}function u(e,t,i,a){$("#alert #headline").removeAttr("class"),$("#alert #headline").html(e),$("#alert #content").html(t),void 0!=a&&$("#alert #headline").addClass(a),$("#alert").css("display","block"),$("#alert").css("opacity","0.8"),setTimeout(function(){$("#alert").css("opacity","0"),setTimeout(function(){$("#alert").css("display","none")},510)},i)}function v(){$("head > style").remove(),$("html > head").append("<style>h1{font-size:"+$(window).width()/400+"em;} #detail{font-size:"+$(window).width()/1600+"em;} #calendar_wrapper #headline{font-size:"+$(window).width()/400+"em;} #close_fullscreen{font-size:"+$(window).width()/800+"em;}; #detail #info #close{font-size:"+$(window).width()/800+"em;} #views #container{font-size:"+$(window).width()/400+"em;} #views #header{font-size:"+$(window).width()/700+"em;} #views .eventinweek>div{font-size:"+$(window).width()/1600+"em}</style>"),$("#views").css({height:$(window).height()-$("#calendar_wrapper #headline").outerHeight()+"px",top:$("#calendar_wrapper #headline").outerHeight()+"px"}),$("#views #container").css({height:$("#views").outerHeight()-$("#views #header").outerHeight()+"px"})}function w(e){return eventColor="",eventWord="",currentDate=new Date,eventDate=new Date(e+"Z"),eventWord=currentDate.getDate()==eventDate.getDate()?eventDate.getHours()<6?"Early today:":eventDate.getHours()<10?"This morning:":eventDate.getHours()<17?"This afternoon:":eventDate.getHours()<22?"This evening:":"Tonight:":currentDate.getDate()+1==eventDate.getDate()?eventDate.getHours()<6?"Early tomorrow:":eventDate.getHours()<10?"Tomorrow morning:":eventDate.getHours()<17?"Tomorrow afternoon:":eventDate.getHours()<22?"Tomorrow evening:":"Tomorrow night:":"On "+eventDate.getFullYear()+"/"+("0"+(eventDate.getMonth()+1)).slice(-2)+"/"+("0"+eventDate.getDate()).slice(-2)+":",eventColor=eventDate.getHours()<6?"#010F47":eventDate.getHours()<10?"#ff2d00":eventDate.getHours()<17?"#ff8c00":eventDate.getHours()<22?"#d90000":"#010F47",[eventWord,eventColor]}function g(e){events=[],$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"list",format:"json"},function(t,i){void 0!=t.error?u(t.error.text,"There seems to be a problem with the database.<br>Please try again later.",5e3,"error"):($.each(t.events.events,function(e,t){t.start=new Date(new Date(t.start+"Z").getTime()+36e5*currentTimezone).toISOString().substr(0,16),t.end=new Date(new Date(t.end+"Z").getTime()+36e5*currentTimezone).toISOString().substr(0,16),events.push(t)}),events.sort(function(e,t){return new Date(e.start).getTime()<new Date(t.start).getTime()?-1:1}),h(listViewDay),b(),void 0!=e&&e(t,i))})}function h(e){$("#calendar_wrapper #appointment_list .aptlst").remove(),$("#calendar_wrapper #appointment_list div").css("display","none"),today=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+e,currentTimezone,0,0,0),isaa=today,"detail"!=state.split("_")[0]&&_(isaa),thistime=new Date,$("#calendar_wrapper #day #current").html(0==e?"Today":1==e?"Tomorrow":-1==e?"Yesterday":today.getUTCFullYear()+"/"+("0"+(today.getUTCMonth()+1)).slice(-2)+"/"+("0"+today.getUTCDate()).slice(-2)),thisDay=[];var t=0;if(void 0!=events[t]){for(;new Date(events[t].start).getTime()<today.getTime()&&(t++,void 0!=events[t]););if(void 0!=events[t])for(;new Date(events[t].start).getTime()<today.getTime()+864e5&&(eventdate=new Date(new Date(events[t].start+"Z").getTime()-36e5*currentTimezone),eventlengthtmp=new Date(new Date(events[t].end+"Z").getTime()-eventdate.getTime()),eventlength=eventlengthtmp.getUTCHours()+" hours "+eventlengthtmp.getUTCMinutes()+" minutes",eventrange="",eventdate.getHours()<6?(eventrange="early",nexteventrange="morning"):eventdate.getHours()<10?(eventrange="morning",nexteventrange="afternoon"):eventdate.getHours()<17?(eventrange="afternoon",nexteventrange="evening"):eventdate.getHours()<22?(eventrange="evening",nexteventrange="night"):(eventrange="night",nexteventrange="endday"),$("#calendar_wrapper #appointment_list #"+eventrange).css("display","block"),$("#appointment_list #"+nexteventrange).before('<div id="'+events[t].id+'"class="aptlst"><div id="time">'+events[t].start.slice(-5)+" - "+eventlength+"</div>"+events[t].title+'<div id="delete"><img src="img/trash.svg"></div></div>'),t++,void 0!=events[t]););}}function b(){y?(T(0,events,isaa),y=!y):($("#views #time").remove(),$("#views #container > div").remove(),H(cm,cy))}function D(e){state="detail_"+e,$.each(events,function(t,i){return i.id==e?($("#detail #title").val(i.title),$("#detail #status img").css({width:"0px"}),"Free"==i.status?$("#detail #status img#free").css({width:"3%"}):"Busy"==i.status?$("#detail #status img#busy").css({width:"3%"}):$("#detail #status img#tentative").css({width:"3%"}),tmpeventstartdate=new Date(new Date(i.start+"Z").getTime()-36e5*currentTimezone),tmpeventenddate=new Date(new Date(i.end+"Z").getTime()-36e5*currentTimezone),$("#detail #time #text #startdatey").val(tmpeventstartdate.getFullYear()),$("#detail #time #text #startdatem").val(("0"+(tmpeventstartdate.getMonth()+1)).slice(-2)),$("#detail #time #text #startdated").val(("0"+tmpeventstartdate.getDate()).slice(-2)),$("#detail #time #text #starttimeh").val(("0"+tmpeventstartdate.getHours()).slice(-2)),$("#detail #time #text #starttimem").val(("0"+tmpeventstartdate.getMinutes()).slice(-2)),$("#detail #time #text #enddatey").val(tmpeventenddate.getFullYear()),$("#detail #time #text #enddatem").val(("0"+(tmpeventenddate.getMonth()+1)).slice(-2)),$("#detail #time #text #enddated").val(("0"+tmpeventenddate.getDate()).slice(-2)),$("#detail #time #text #endtimeh").val(("0"+tmpeventenddate.getHours()).slice(-2)),$("#detail #time #text #endtimem").val(("0"+tmpeventenddate.getMinutes()).slice(-2)),$("#detail #location #text #locin").val(i.location),$("#detail #organizer #text #orgin").val(i.organizer),$("#detail #organizer #text #website").val(i.webpage),$("#detailimg").css("background-image","url("+(""==i.imageurl?"img/detail_standard.png":i.imageurl)+")"),!1):void 0}),3==viewstate?(goheight=$("#calendar_wrapper #appointment_list #"+e).height(),gowidth=$(window).width(),gooffsettop=$("#calendar_wrapper #appointment_list #"+e).offset().top,gooffsetleft=0):0==viewstate&&(goheight=$("#views .event-"+e).height(),gowidth=$("#views .event-"+e).width(),gooffsettop=$("#views .event-"+e).offset().top,gooffsetleft=$("#views .event-"+e).offset().left),$("#detail").css("display","block"),$("#detail").css({"margin-top":"-"+$("#detail #info").outerHeight()+"px"}),$("#detailimg").css({height:goheight+"px",width:gowidth+"px","margin-left":gooffsetleft+"px","margin-top":gooffsettop+"px",display:"block"}),setTimeout(function(){$("#detailimg").css({opacity:"1","margin-top":"0","margin-left":"0",height:"100%",width:"100%"}),setTimeout(function(){$("#detail #info #measure").css({"font-size":"1em","font-family":'"Slabo 27px", "Arial"'}),$("#detail #info #measure").html($("#detail #title").val()),$("#detail #title").width($("#detail #info #measure").width()),$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$.each($('#detail #time input[type="text"]'),function(e,t){$("#detail #info #measure").html($(t).val()),$(t).width($("#detail #info #measure").width())}),$("#detail #info #measure").html($('#detail #info #location input[type="text"]').val()),$('#detail #info #location input[type="text"]').width($("#detail #info #measure").width()),$.each($('#detail #organizer input[type="text"]'),function(e,t){$("#detail #info #measure").html(""!=$(t).val()?$(t).val():"no website"),$(t).width($("#detail #info #measure").width())}),$("#detail").css({opacity:"1","margin-top":"0px"})},300)},1)}function k(){id=state.split("_")[1],state="calendar",$("#detail").css({opacity:"0","margin-top":"-"+$("#detail #info").outerHeight()+"px"}),setTimeout(function(){$("#detailimg").css({height:goheight+"px",width:gowidth+"px","margin-left":gooffsetleft+"px","margin-top":gooffsettop+"px"}),setTimeout(function(){$("#detailimg").css("opacity","0"),setTimeout(function(){$("#detail").css("display","none"),$("#detailimg").css("display","none")},150)},150)},500)}function T(e,t,a){for(events=t,cm=a.getMonth()+1,cy=a.getFullYear(),$("#views #header #days").remove(),$("#views #header").append("<div id='days'></div>"),i=0;7>i;i++)$("#views #days").append(6!=i?"<div class='cell h'>"+I(i)+"</div>":"<div class='lastcell cell h'>"+I(i)+"</div>");viewstate=e,0==e?H(cm,cy):1==e&&(H(cm,cy),setTimeout(function(){S(fwr)},500)),v(),viewstate=3}function _(e){curmonth=e.getMonth()+1,curmonth>cm?(viewstate=0,z(1),viewstate=3):cm>curmonth&&(viewstate=0,z(-1),viewstate=3)}function z(e){$("#views #container > div").remove(),0==viewstate?(0>e&&(cm--,0==cm&&(cm=12,cy--)),e>0&&(cm++,13==cm&&(cm=1,cy++)),H(cm,cy)):1==viewstate&&(0>e?(rn--,fwr>rn&&(cm--,0==cm&&(cm=12,cy--),H(cm,cy),$("#views #container > div").remove(),rn=lwr,6!=new Date(Date.UTC(cy,cm,0)).getDay()&&rn--)):e>0&&(rn++,rn>lwr&&(rn=1,cm++,13==cm&&(cm=1,cy++))),H(cm,cy),S(rn))}function H(e,t){$("#views .head").html(M(e-1)+" "+t),C();var i,a,n,s,o,l,d,u,v,m,w,g;for(n=0,o=new Date(Date.UTC(t,e-1,1)).getDay(),e-1==0?(v=12,u=t-1,l=new Date(Date.UTC(u,v,0)).getDate()):(v=e-1,u=t,l=new Date(Date.UTC(u,v,0)).getDate()),fwr=0,0==o&&(o=7,fwr=1,n++),d=l-o+1,y=0;o-1>=y;y++)i="r0f"+y,$("#views #"+i).css("color","grey"),g=u+"-"+("0"+v).slice(-2)+"-"+("0"+d).slice(-2),$("#views #"+i).append("<div class='dates omonth' id='list-"+g+"'>"+d+"</div>"),$("#views #"+i).append("<div id='"+g+"' class='events pm'></div>"),d++;s=new Date(Date.UTC(t,e,0)),d=s.getDate();for(var y=0;d-1>=y;y++)s.setDate(y+1),a=s.getDay(),i="r"+n+"f"+a,g=t+"-"+("0"+e).slice(-2)+"-"+("0"+(y+1)).slice(-2),$("#views #"+i).append("<div class='dates' id='list-"+g+"'>"+(y+1)+"</div>"),$("#views #"+i).append("<div id='"+g+"' class='events'></div>"),lwr=n,6==a&&n++;for(td=new Date,tdid=td.getFullYear()+"-"+("0"+(td.getMonth()+1)).slice(-2)+"-"+("0"+td.getDate()).slice(-2),$("#list-"+tdid).css("background-color","#04756f"),d=1,12==e?(w=1,m=t+1):(w=e+1,m=t),6==a&&(a=-1),r=n;7>r;r++){for(f=a+1;7>f;f++)i="r"+r+"f"+f,$("#views #"+i).css("color","grey"),g=m+"-"+("0"+w).slice(-2)+"-"+("0"+d).slice(-2),$("#views #"+i).append("<div class='dates omonth' id='list-"+g+"'>"+d+"</div>"),$("#views #"+i).append("<div id='"+g+"' class='events nm'></div>"),d++;a=-1}0==viewstate&&W(),$("#views .dates").on("click",function(){id=$(this).attr("id"),id=id.slice(-10),date1=new Date(new Date(id).getTime()-3600*currentTimezone*1e3),date2=new Date,timeDiff=date1.getTime()-date2.getTime(),diffDays=Math.ceil(timeDiff/864e5),p(),listViewDay=diffDays,h(listViewDay)})}function I(e){var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t[e]}function M(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e]}function C(){for(r=0;6>r;r++)for(f=0;7>f;f++)$("#views #container").append(6==f?"<div id='new' class='lastcell cell '></div>":"<div id='new' class='cell'></div>"),$("#views #new").attr("id","r"+r+"f"+f)}function S(e){viewstate=1;var t;for(r=0;6>r;r++)for(f=0;7>f;f++)t="r"+r+"f"+f,r!=e&&$("#views #"+t).remove();var a=$("#views #container div[id]").map(function(){return this.id}).get();for(a.sort(),$("#views .cell").addClass("week"),$("#views .lastcell").addClass("week"),$("#views .dates").addClass("w"),$("#views #container").prepend("<div id='timelinecontainer' class='cell time'style='font-size:0.3em'>Time</div>"),$("#views #container").append("<div id='timeline' class='cell time'></div>"),i=0;24>i;i++){var n=("0"+i+":00").slice(-5);$("#views #timeline").append("<div class='time side'>"+n+"</div>")}for(i=0;7>i;i++)$("#views #"+a[i]).remove();for($("#views #timeline").append("<div id='eiwc'></div>"),i=0;7>i;i++)$("#views #eiwc").append("<div class='eventinweek' id='"+a[i]+"'></div>");$("#views #"+a[6]).addClass("lastday");var s=[];s[0]=M(parseInt(a[0].slice(5,7))-1),s[1]=parseInt(a[0].slice(8,10)),s[2]=a[0].slice(0,4),s[3]=M(parseInt(a[6].slice(5,7))-1),s[4]=parseInt(a[6].slice(8,10)),s[5]=a[6].slice(0,4),$("#views .head").html(s[0]+" "+s[1]+", "+s[2]+" - "+s[3]+" "+s[4]+", "+s[5]),W()}function W(){if(0==viewstate){for(i=0;i<events.length;i++)E(events[i].id,events[i].title,events[i].start,events[i].end);$(".eventinmonth").on("click",function(){rx=new RegExp("[0-9]+"),id=parseInt(rx.exec($(this).attr("class"))),D(id)})}else if(1==viewstate){for(i=0;i<events.length;i++)A(events[i].id,events[i].title,events[i].start,events[i].end,events[i].allday,events[i].imageurl);$(".eventinweek").each(function(){co=0,day=$(this).attr("id"),$("#"+day+">div").each(function(){co++,co>1&&(ec=$(this).attr("class"),$("#views #"+day+"> div").css("width","45%"),$("#views #"+day+"> div").css("float","left"),$("#views #"+day+"> ."+ec).css("margin-left","55%"))})}),$(".eventinweek > div").on("click",function(){rx=new RegExp("[0-9]+"),id=parseInt(rx.exec($(this).attr("class"))),D(id)})}}function A(e,t,i,a,n){var r=i.slice(0,10),o=parseInt(i.slice(-5,-3));o+=parseInt(i.slice(-2))/60;var l=U(i,a);$("#views #"+r).append("<div class='event-"+e+"'></div>"),$("#views .event-"+e).append("<div class='eventtitle'>"+t+"</div>"),$("#views .event-"+e).css("position","absolute"),$("#views .event-"+e).css("z-index",e),color=w(i),$("#views .event-"+e).css("background-color",color[1]),$("#views .event-"+e).css("margin-top",F(o)+"px"),$("#views .event-"+e).css("height",Y(e,o,l,r,n,color[1])),sizecomp=$(".event-"+e).height()/$(".event-"+e+" .eventtitle").height(),1>sizecomp&&$(".event-"+e+" .eventtitle").css("font-size",sizecomp+"em")}function E(e,t,i,a){var n=i.slice(0,10),r=(a.slice(0,10),i.slice(11,16)),o=a.slice(11,16);for(startd=new Date(i),a=new Date(a),d1=startd.getTime(),d2=a.getTime(),c=0;d2>=d1;)d=startd.getDate(),startd.setDate(d+1),d1=startd.getTime(),0==c?(line1=t,line2=r+" - 23:59"):(line1=t,line2=" All Day ",n=n.slice(0,8)+("0"+(parseInt(n.slice(-2))+1)).slice(-2)),$("#views #"+n).append("<div class='eventinmonth event-"+e+"'><div>"+line1+"</div><div>"+line2+"</div></div>"),color=w(i),$("#views .event-"+e).css("background-color",color[1]),c++;1!=c?(line1=t,line2="00:00 - "+o):(line1=t,line2=r+" - "+o),$("#views #"+n+" .event-"+e).html("<div>"+line1+"</div><div>"+line2+"</div>")}function F(e){var t=37,i=e*t;return i}function Y(e,t,i,a,n,s){var r=35.4,l=0,d=.0166;for(pl=0;i>pl;pl+=d)l+=r*d;var c=$("#views #eiwc").height()-F(t);return l>c?(O(e,l-c,a,s),c+50+"px"):l+"px"}function O(e,t,i,a){var n=parseInt(i.slice(-2)),s=parseInt(i.slice(5,7)),r=parseInt(i.slice(0,4));n++,n>new Date(r,s,0).getDate()&&(n=1,s++,(s=13)&&(s=1,r++)),n=("0"+n).slice(-2),s=("0"+s).slice(-2),i=r+"-"+s+"-"+n;var o=$("#views #eiwc").height();t>o?($("#views #"+i).append("<div id='offset-"+n+"' class='event-"+e+"'></div>"),$("#views #offset-"+n).css("height",o+50+"px"),$("#views #offset-"+n).css("background-color",a),$("#views #offset-"+n).css("border-top","none"),O(e,t-o,i,a)):($("#views #"+i).append("<div id='offset-"+n+"'></div>"),$("#views #offset-"+n).css("height",t+"px"),$("#views #offset-"+n).css("background-color",a),$("#views #offset-"+n).css("border-top","none")),oss=1}function U(e,t){var i=new Date(e),a=new Date(t),n=a-i,s=n/1e3,r=Math.floor(s/3600),o=Math.floor(s%3600)/60;return r+o/60}$(window).load(function(){function d(e){1!=r?($(this).parent().find("img").css({width:"3%","background-color":"rgba(0,0,0,0.3)",padding:"0 0.5%"}),r=!0):($(this).parent().find("img:not(#"+e.target.id+")").css({width:"0"}),$(this).parent().find("img").css({"background-color":"transparent",padding:"0 0"}),r=e.target.id)}if(void 0==$.cookie("overview")?$.cookie("overview","true"):"false"==$.cookie("overview")&&$("#calendar_wrapper #headline #settings #content #overview").attr("src","img/checkbox_unchecked.svg"),v(),void 0==$.cookie("user"))$("#welcome h1").css("opacity","1"),setTimeout(function(){state="user",e("welcome","user",'Choose your name<br><input id="username" type="text" maxlength="10">',"#04858f"),setTimeout(function(){$("#user #username").focus()},100)},3e3);else{state="user",$("#calendar_wrapper #headline #settings #content #loggedin").attr("src","img/checkbox_checked.svg");var t=jQuery.Event("keypress");t.which=13,$(document).trigger(t)}$("#calendar_wrapper #headline #new_entry").click(function(){state="newapt1",0==viewstate||1==viewstate?(viewswerehere=!0,p()):viewswerehere=!1,n(),a("name",'What\'s going on?*<br><input id="aptname" type="text"><br><span style="font-size:0.5em">*required</span>',"#024d25"),$("#aptname").focus()}),$("#close_fullscreen").click(function(){viewswerehere&&p(),n()}),$("#calendar_wrapper #day #next").click(function(){$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","0"),setTimeout(function(){listViewDay++,h(listViewDay),$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","1")},500)}),$("#calendar_wrapper #day #back").click(function(){$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","0"),setTimeout(function(){listViewDay--,h(listViewDay),$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","1")},500)}),$("#detail #info #close").click(function(){k()}),$("#calendar_wrapper #headline #settings > img").click(function(){s()}),$("#calendar_wrapper #headline #settings #content #overview").click(function(){o()}),$("#calendar_wrapper #headline #settings #content #loggedin").click(function(){l()}),$("#calendar_wrapper #headline #toggle_view").click(function(){p()}),$(document).on("click","#calendar_wrapper #appointment_list .aptlst #delete",function(e){e.stopPropagation(),$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"delete",format:"json",id:$(this).parent().attr("id")},function(e){void 0!=e.error?u("Error","The element could not be deleted. The error is<br>#"+e.error.id+": "+e.error.text,4e3,"error"):g(function(){u("Deleted","The element was successfully deleted.",4e3,"success")})})}),$(document).on("click","#calendar_wrapper #appointment_list .aptlst",function(){D($(this).attr("id"))}),$(document).on("mouseover","#calendar_wrapper #appointment_list .aptlst #delete",function(){$(this).find("img").attr("src","img/trash_hover.svg")}),$(document).on("mouseout","#calendar_wrapper #appointment_list .aptlst #delete",function(){$(this).find("img").attr("src","img/trash.svg")}),$(document).on("mouseover","#calendar_wrapper #appointment_list .aptlst",function(){$(this).find("#delete").css("opacity","1"),$(this).find("#time").css("color","#000000")}),$(document).on("mouseout","#calendar_wrapper #appointment_list .aptlst",function(){$(this).find("#delete").css("opacity","0"),$(this).find("#time").css("color","#bbbbbb")});var i=!1;$("#detail #info #edit").click(function(){i?($(this).css({transform:"rotate(-360deg) scale(0)","background-color":"transparent"}),setTimeout(function(){$("#detail #info #edit img").attr("src","img/edit.svg"),$("#detail #info #edit").css({transform:"rotate(0deg) scale(1)"})},250),$('#detail #info input[type="text"]').attr("disabled","true"),(0!=r||void 0!=r)&&$("#detail #info #status").click(),$("#detail #info #status img").off("click"),$("#detail #info #status img").css({cursor:"auto"}),editstart=$("#detail #info #startdatey").val()+"-"+$("#detail #info #startdatem").val()+"-"+$("#detail #info #startdated").val()+"T"+$("#detail #info #starttimeh").val()+":"+$("#detail #info #starttimem").val(),editend=$("#detail #info #enddatey").val()+"-"+$("#detail #info #enddatem").val()+"-"+$("#detail #info #enddated").val()+"T"+$("#detail #info #endtimeh").val()+":"+$("#detail #info #endtimem").val(),editstart=new Date(new Date(editstart+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),editend=new Date(new Date(editend+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"update",format:"json",id:state.split("_")[1],title:$("#detail #info #title").val(),location:$("#detail #info #locin").val(),organizer:$("#detail #info #orgin").val(),start:editstart,end:editend,status:r.substr(0,1).toUpperCase()+r.substr(1),allday:0,webpage:$("#detail #info #website").val()},function(e){void 0!=e.error?(u("No edit today<br>my app has broke away","Dang it!<br>#"+e.error.id+" with message<br>"+e.error.text+"<br>has occured.",7500,"error"),D(state.split("_")[1])):u("Edit successful",$("#detail #info #title").val()+" was edited.",3500,"success"),g()})):(u("Edit enabled","Just click on the entries you want to edit.<br>Afterwards, click on the save icon.",3500),$(this).css({transform:"rotate(-360deg) scale(0)"}),setTimeout(function(){$("#detail #info #edit img").attr("src","img/save.svg"),$("#detail #info #edit").css({transform:"rotate(-720deg) scale(1)","background-color":"rgba(0,0,0,0.3)"})},250),$.each($("#detail #info #status img"),function(e,t){"0px"!=$(t).css("width")&&(r=$(t).attr("id"))}),$('#detail #info input[type="text"]').removeAttr("disabled"),$("#detail #info #status img").click(d),$("#detail #info #status img").css({cursor:"pointer"})),i=!i}),$("#detail #info #title").focusin(function(){$(this).css({width:"90%","background-color":"rgba(0,0,0,0.3)"})}),$("#detail #info #title").focusout(function(){$("#detail #info #measure").css({"font-size":"1em","font-family":'"Slabo 27px", "Arial"'}),$("#detail #info #measure").html($("#detail #title").val()),$(this).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})}),$.each($('#detail #info #time input[type="text"]'),function(e,t){$(t).focusin(function(){$(this).css({width:"7.5%","background-color":"rgba(0,0,0,0.3)"})}),$(t).focusout(function(){$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$("#detail #info #measure").html($(this).val()),$(this).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})})}),$.each($('#detail #info #location input[type="text"]'),function(e,t){$(t).focusin(function(){$(t).css({width:"90%","background-color":"rgba(0,0,0,0.3)"})}),$(t).focusout(function(){$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$("#detail #info #measure").html($(t).val()),$(t).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})})}),$.each($('#detail #info #organizer input[type="text"]'),function(e,t){$(t).focusin(function(){$(t).css({width:"45%","background-color":"rgba(0,0,0,0.3)"})}),$(t).focusout(function(){$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$("#detail #info #measure").html(""!=$(t).val()?$(t).val():"no website"),$(t).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})})});var r=!0}),$(window).resize(function(){v()});var m="";$(document).keypress(function(a){if(13==a.which)if("user"==state){void 0==$.cookie("user")?(e("user","userloading",'<img src="img/loading.svg" style="height:100px; width:100px">',"#04959f"),user=$("#user #username").val()):(e("welcome","userloading",'<img src="img/loading.svg" style="height:100px; width:100px">',"#04959f"),user=$.cookie("user")),state="calendarlist";var s=[],r=[],o=[];g(function(){if(i=0,tmpdate=(new Date).getTime(),void 0!=events[i])for(;new Date(events[i].start).getTime()<tmpdate&&(i++,void 0!=events[i]););for(j=0;3>j;j++){if(void 0!=events[i])s[j]=events[i].title,r[j]=events[i].start.split("T")[1],o[j]=w(events[i].start);else{if(0==j){s[0]="This is where your day is shown and you have a quick look",r[0]="it",o[0]=["","#024d25"],s[1]="The colors indicate the daytime. This would be",r[1]="night",o[1]=["","#010f47"],s[2]="and enjoy making appointments",r[2]="this place",o[2]=["So welcome -","#d90000"];break}1==j?(s[j]="You're free",r[j]="this time",o[j]=["Enjoy!","#024d25"]):2==j&&(s[j]="Nothing more",r[j]="the moment",o[j]=["Free Time!","#024d25"])}i++}greeting=0==currentDaytime?"Have a good night,":1==currentDaytime?"Good morning,":2==currentDaytime?"Hello":"Good evening,",e("userloading","hello",greeting+" "+user+"!","#04959f"),"true"==$.cookie("overview")?setTimeout(function(){t("hello",25,75,"#04756f",o[0][1]),setTimeout(function(){e("hello","nextaptmnt",o[0][0]+" "+s[0]+" at "+r[0]+".",o[0][1])},1100),setTimeout(function(){t("nextaptmnt",25,50,o[0][1],o[1][1]),setTimeout(function(){e("nextaptmnt","2ndaptmnt",o[1][0]+" "+s[1]+" at "+r[1]+".",o[1][1]),setTimeout(function(){t("2ndaptmnt",25,25,o[1][1],o[2][1]),setTimeout(function(){e("2ndaptmnt","3rdaptmnt",o[2][0]+" "+s[2]+" at "+r[2]+".",o[2][1]),setTimeout(function(){n(),setTimeout(function(){$("#close_fullscreen").css("display","block")},1e3)},2400)},1100)},2400)},1100)},3500)},2e3):setTimeout(function(){n(),setTimeout(function(){$("#close_fullscreen").css("display","block")},1e3)},2e3)})}else if("newapt1"==state)state="newapt2",e("name","place",'Where do you go?*<br><input id="aptplace" type="text">',"#024d25"),$("#aptplace").focus();else if("newapt2"==state)state="newapt3",e("place","corganizer",'Who planned this?*<br><input id="aptorganizer" type="text" placeholder="Mail Address">',"#024d25"),$("#aptorganizer").focus();else if("newapt3"==state)state="newapt4",e("corganizer","start",'When do you go?*<br><input id="aptyear" type="text" maxlength="4" placeholder="YYYY" style="width:15%"><input id="aptmonth" type="text" maxlength="2" placeholder="MM" style="width:7.5%; margin:0 0.5%"><input id="aptday" type="text" maxlength="2" placeholder="DD" style="width:7.5%"><br><input id="apthour" type="text" maxlength="2" placeholder="HH" style="width:7.5%">:<input id="aptminute" type="text" maxlength="2" placeholder="MM" style="width:7.5%">',"#024d25"),$("#aptyear").focus();else if("newapt4"==state)state="newapt5",e("start","end",'How long is this event?*<br><input id="aptlhour" type="text" style="margin-bottom:2%; width:10%">h<input id="aptlminutes" type="text" maxlength="2" style="margin-bottom:2%; width:10%">min '+currTimezString+'<br><a href="javascript:void(0)" id="aptallday">All Day</a>',"#024d25"),aptallday=!1,$("#aptallday").click(function(){aptallday=!0;var e=jQuery.Event("keypress");e.which=13,$(document).trigger(e)}),$("#aptlhour").focus();else if("newapt5"==state)state="newapt6",e("end","status",'Are you available whilst this?*<br><a href="javascript:void(0)" id="aptfree">Free</a><a href="javascript:void(0)" id="aptbusy">Busy</a><a href="javascript:void(0)" id="apttent">Tentative</a>',"#024d25"),$("#aptfree").click(function(){m="Free",state="newapt7",e("status","webpage",'Is there a website?<br><input id="aptwebsite" type="text"><br><span style="font-size:0.5em">Enter to skip</span>',"#024d25"),$("#aptwebsite").focus()}),$("#aptbusy").click(function(){m="Busy",state="newapt7",e("availability","webpage",'Is there a website?<br><input id="aptwebsite" type="text"><br><span style="font-size:0.5em">Enter to skip</span>',"#024d25"),$("#aptwebsite").focus()}),$("#apttent").click(function(){m="Tentative",state="newapt7",e("availability","webpage",'Is there a website?<br><input id="aptwebsite" type="text"><br><span style="font-size:0.5em">Enter to skip</span>',"#024d25"),$("#aptwebsite").focus()});else if("newapt7"==state)state="newapt8",e("webpage","image",'Do you want to attach an image?<br><a href="javascript:void(0)" id="aptimgsel">Choose Image</a><input id="aptimage" type="file" accept="image/jpeg, image/png" style="display:none;"><br><span style="font-size:0.5em">Enter to skip or continue</span>',"#024d25"),$("#aptimgsel").click(function(){$("#aptimage").click(),$("#aptimgsel").blur()});else if("newapt8"==state){aptallday?(aptstart=$("#aptyear").val()+"-"+$("#aptmonth").val()+"-"+$("#aptday").val()+"T00:00",aptend=$("#aptyear").val()+"-"+$("#aptmonth").val()+"-"+$("#aptday").val()+"T23:59",aptalldaynum="1"):(enddate=new Date(parseInt($("#aptyear").val()),parseInt($("#aptmonth").val()-1),parseInt($("#aptday").val()),parseInt($("#apthour").val())+parseInt($("#aptlhour").val()),parseInt($("#aptminute").val())+parseInt($("#aptlminutes").val()),0,0),aptstart=$("#aptyear").val()+"-"+$("#aptmonth").val()+"-"+$("#aptday").val()+"T"+$("#apthour").val()+":"+$("#aptminute").val(),aptend=enddate.getFullYear()+"-"+("0"+(enddate.getMonth()+1)).slice(-2)+"-"+("0"+enddate.getDate()).slice(-2)+"T"+("0"+enddate.getHours()).slice(-2)+":"+("0"+enddate.getMinutes()).slice(-2),aptalldaynum="0");try{aptstart=new Date(new Date(aptstart+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),aptend=new Date(new Date(aptend+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),timeerror=!1}catch(a){timeerror=!0}$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"add",format:"json",title:$("#aptname").val(),location:$("#aptplace").val(),organizer:$("#aptorganizer").val(),start:aptstart,end:aptend,status:m,allday:aptalldaynum,webpage:$("#aptwebsite").val()},function(t){function a(){state="newaptsummary",tmpname=$("#aptname").val().length<23?$("#aptname").val():$("#aptname").val().slice(0,20)+"...",$("#close_fullscreen").css("opacity","0"),e("image","sumloading",'<img src="img/loading.svg" style="height:100px; width:100px">',"#024d25"),g(function(){aptallday?e("sumloading","summary","Your appointment has been saved!<br>"+tmpname+"<br>All day on "+$("#aptyear").val()+"/"+$("#aptmonth").val()+"/"+$("#aptday").val()+"!","#024d25"):e("sumloading","summary","Your appointment has been saved!<br>"+tmpname+"<br>On "+$("#aptyear").val()+"/"+$("#aptmonth").val()+"/"+$("#aptday").val()+" at "+$("#apthour").val()+":"+$("#aptminute").val()+"!","#024d25"),setTimeout(function(){state="calendar",$("#close_fullscreen").css("opacity","1"),n()
},4e3)})}void 0!=t.error||1==timeerror?e("image","summary","Oh Snap!<br>#"+t.error.id+": "+t.error.text+'<br>Please contact <a href="http://twitter.com/4dialects">us</a> about this error so we can fix it!',"#8f0000"):void 0!=document.getElementById("aptimage").files[0]?(fd=new FormData,fd.append("user",user),fd.append("action","upload-image"),fd.append("format","json"),fd.append("id",t.add.id),fd.append("file",document.getElementById("aptimage").files[0]),$.ajax({url:"http://host.bisswanger.com/dhbw/calendar.php",type:"POST",processData:!1,contentType:!1,data:fd,success:function(t){void 0!=t.error?(e("image","summary","Your appoinment has been saved but:<br>No picture for you today!<br>#"+t.error.id+": "+t.error.text+'<br>Please contact <a href="http://twitter.com/4dialects">us</a> about this error so we can fix it!',"#ff8c00"),g()):a()}})):a()})}}),$(document).keyup(function(e){if(notnum=new RegExp("[^0-9]"),fe=$("*:focus").attr("id"),val=$("#"+fe).val(),"newapt4"==state)if(null!=val.match(notnum)&&$("#"+fe).val(val.slice(0,$("#"+fe).val().length-1)),8!=e.which){if($("#"+fe).val().length>=2)switch(fe){case"aptyear":4==$("#aptyear").val().length&&$("#aptmonth").focus();break;case"aptmonth":$("#aptday").focus();break;case"aptday":$("#apthour").focus();break;case"apthour":$("#aptminute").focus()}}else if(null!=val.match(notnum)&&$("#"+fe).val(val.slice(0,$("#"+fe).val().length-1)),0==$("#"+fe).val().length)switch(fe){case"aptminute":$("#apthour").focus();break;case"apthour":$("#aptday").focus();break;case"aptday":$("#aptmonth").focus();break;case"aptmonth":$("#aptyear").focus()}"newapt5"==state&&(8!=e.which?2==$("#"+fe).val().length&&"aptlhour"==fe&&$("#aptlminutes").focus():0==$("#"+fe).val().length&&"aptlminutes"==fe&&$("#aptlhour").focus())});var y=!0;$("#views #back").click(function(){z(-1)}),$("#views #forward").click(function(){z(1)}),$("#views #weekview").click(function(){0==viewstate&&($("#views #days").prepend("<div class='time' id='time' style='float:left'>&nbsp;</div>"),S(fwr),viewstate=1)}),$("#views #monthview").click(function(){1==viewstate&&($("#views #time").remove(),$("#views #container > div").remove(),viewstate=0,H(cm,cy))}),$(document).keydown(function(e){3!=viewstate&&(37==e.keyCode?z(-1):39==e.keyCode?z(1):27==e.keyCode&&($("#views #time").remove(),$("#views #container > div").remove(),viewstate=0,H(cm,cy)))})});
=======
var state="welcome",user="",currentTimezone=(new Date).getTimezoneOffset()/60*-1,currTimezString="GMT"+(0>currentTimezone?"-":"+")+("0"+Math.floor(Math.abs(currentTimezone))).slice(-2)+("0"+60*(Math.abs(currentTimezone)-Math.floor(Math.abs(currentTimezone)))).slice(-2),listViewDay=0,isaa,events=[],cm=0,cy=0,viewstate,rn=0,lwr=0,fwr=0,oss=0,currentDatetime=new Date,currentDaytime,goheight,gowidth,gooffsettop,gooffsetleft;currentDaytime=currentDatetime.getHours()<6?0:currentDatetime.getHours()<10?1:currentDatetime.getHours()<17?2:currentDatetime.getHours()<22?3:0,$(document).ready(function(){function e(e,t,i,a){$("#fullscreen").append('<div id="'+t+'" style="background-color:'+a+"; z-index:"+(parseInt($("#"+e).css("z-index"))-1)+'"><h1 style="opacity:0; margin-left:50%">'+i+"</h1></div>"),$("#fullscreen #"+e).css({opacity:"0"}),$("#fullscreen #"+e+" h1").css({"margin-left":"-50%",opacity:"0"}),setTimeout(function(){$("#fullscreen #"+t+" h1").css({"margin-left":"0%",opacity:"1"}),setTimeout(function(){$("#fullscreen #"+e).css("display","none")},1e3)},100)}function t(e,t,i,a,n){$("body").css("background-color",n),$("#"+e).css({height:t+"%","background-color":a}),setTimeout(function(){$("#"+e).css("display","none"),$("#outer_fullscreen").append('<div id="outer_'+e+'" style="background-color:'+a+"; height:"+t+"%; top:"+(100-t-i)+'%">'+$("#"+e).html()+"</div>"),$("#fullscreen").css({height:i+"%",top:100-i+"%"})},1100)}function a(e,t,i){$("#fullscreen").html('<div id="'+e+'" style="background-color:'+i+'"><h1>'+t+"</h1></div>"),$("#outer_fullscreen").html(""),$("#fullscreen, #outer_fullscreen").removeAttr("style")}function n(){"0px"==$("#calendar_wrapper").css("margin-top")?$("#calendar_wrapper").css("margin-top","-150%"):(state="calendar",$("#calendar_wrapper").css("margin-top","0px"))}function s(){"0px"==$("#calendar_wrapper #headline #settings #content").css("width")?($("#calendar_wrapper #headline #settings #content").css({padding:"0.125em 0.5em",width:"90%"}),$("#calendar_wrapper #headline #text").css("opacity","0"),setTimeout(function(){$("#calendar_wrapper #headline #text").css({width:"0px","margin-left":"-200%"})},1e3)):($("#calendar_wrapper #headline #text").css({width:"auto","margin-left":"0"}),$("#calendar_wrapper #headline #settings #content").css({padding:"0.125em 0em",width:"0px"}),$("#calendar_wrapper #headline #text").css("opacity","1"))}function o(){"true"==$.cookie("overview")?($.cookie("overview","false"),$("#calendar_wrapper #headline #settings #content #overview").attr("src","img/checkbox_unchecked.svg")):($.cookie("overview","true"),$("#calendar_wrapper #headline #settings #content #overview").attr("src","img/checkbox_checked.svg"))}function l(){void 0==$.cookie("user")?($.cookie("user",user),$("#calendar_wrapper #headline #settings #content #loggedin").attr("src","img/checkbox_checked.svg")):($.removeCookie("user"),$("#calendar_wrapper #headline #settings #content #loggedin").attr("src","img/checkbox_unchecked.svg"))}function p(){"0px"==$("#views").css("margin-top")?($("#views").css("margin-top","150%"),viewstate=3):(viewstate=0,$("#views #container > div").remove(),H(cm,cy),$("#views").css("margin-top","0px"))}function u(e,t,i,a){$("#alert #headline").removeAttr("class"),$("#alert #headline").html(e),$("#alert #content").html(t),void 0!=a&&$("#alert #headline").addClass(a),$("#alert").css("display","block"),$("#alert").css("opacity","0.8"),setTimeout(function(){$("#alert").css("opacity","0"),setTimeout(function(){$("#alert").css("display","none")},510)},i)}function v(){$("head > style").remove(),$("html > head").append("<style>h1{font-size:"+$(window).width()/400+"em;} #detail{font-size:"+$(window).width()/1600+"em;} #calendar_wrapper #headline{font-size:"+$(window).width()/400+"em;} #close_fullscreen{font-size:"+$(window).width()/800+"em;}; #detail #info #close{font-size:"+$(window).width()/800+"em;} #views #container{font-size:"+$(window).width()/400+"em;} #views #header{font-size:"+$(window).width()/700+"em;} #views .eventinweek>div{font-size:"+$(window).width()/1600+"em}</style>"),$("#views").css({height:$(window).height()-$("#calendar_wrapper #headline").outerHeight()+"px",top:$("#calendar_wrapper #headline").outerHeight()+"px"}),$("#views #container").css({height:$("#views").outerHeight()-$("#views #header").outerHeight()+"px"})}function g(e){return eventColor="",eventWord="",currentDate=new Date,eventDate=new Date(e+"Z"),eventWord=currentDate.getDate()==eventDate.getDate()?eventDate.getHours()<6?"Early today:":eventDate.getHours()<10?"This morning:":eventDate.getHours()<17?"This afternoon:":eventDate.getHours()<22?"This evening:":"Tonight:":currentDate.getDate()+1==eventDate.getDate()?eventDate.getHours()<6?"Early tomorrow:":eventDate.getHours()<10?"Tomorrow morning:":eventDate.getHours()<17?"Tomorrow afternoon:":eventDate.getHours()<22?"Tomorrow evening:":"Tomorrow night:":"On "+eventDate.getFullYear()+"/"+("0"+(eventDate.getMonth()+1)).slice(-2)+"/"+("0"+eventDate.getDate()).slice(-2)+":",eventColor=eventDate.getHours()<6?"#010F47":eventDate.getHours()<10?"#ff2d00":eventDate.getHours()<17?"#ff8c00":eventDate.getHours()<22?"#d90000":"#010F47",[eventWord,eventColor]}function w(e){events=[],$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"list",format:"json"},function(t,i){void 0!=t.error?u(t.error.text,"There seems to be a problem with the database.<br>Please try again later.",5e3,"error"):($.each(t.events.events,function(e,t){t.start=new Date(new Date(t.start+"Z").getTime()+36e5*currentTimezone).toISOString().substr(0,16),t.end=new Date(new Date(t.end+"Z").getTime()+36e5*currentTimezone).toISOString().substr(0,16),events.push(t)}),events.sort(function(e,t){return new Date(e.start).getTime()<new Date(t.start).getTime()?-1:1}),h(listViewDay),b(),void 0!=e&&e(t,i))})}function h(e){$("#calendar_wrapper #appointment_list .aptlst").remove(),$("#calendar_wrapper #appointment_list div").css("display","none"),today=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+e,currentTimezone,0,0,0),isaa=today,"detail"!=state.split("_")[0]&&_(isaa),thistime=new Date,$("#calendar_wrapper #day #current").html(0==e?"Today":1==e?"Tomorrow":-1==e?"Yesterday":today.getUTCFullYear()+"/"+("0"+(today.getUTCMonth()+1)).slice(-2)+"/"+("0"+today.getUTCDate()).slice(-2)),thisDay=[];var t=0;if(void 0!=events[t]){for(;new Date(events[t].start).getTime()<today.getTime()&&(t++,void 0!=events[t]););if(void 0!=events[t])for(;new Date(events[t].start).getTime()<today.getTime()+864e5&&(eventdate=new Date(new Date(events[t].start+"Z").getTime()-36e5*currentTimezone),eventdend=new Date(new Date(events[t].end+"Z").getTime()-36e5*currentTimezone),eventdate.getDate()==eventdend.getDate()?(eventlength=(eventdate.getMinutes()<=eventdend.getMinutes()?eventdend.getHours()-eventdate.getHours():eventdend.getHours()-eventdate.getHours()-1)+" hours "+(eventdate.getMinutes()<=eventdend.getMinutes()?eventdend.getMinutes()-eventdate.getMinutes():eventdend.getMinutes()-eventdate.getMinutes()+60)+" minutes","23 hours 59 minutes"==eventlength&&(eventlength="All day")):eventlength="Ends on "+eventdend.getFullYear()+"/"+("0"+eventdend.getMonth()+1).slice(-2)+"/"+("0"+eventdend.getDate()).slice(-2),eventrange="","All day"==eventlength?(eventrange="allday",nexteventrange="early"):eventdate.getHours()<6?(eventrange="early",nexteventrange="morning"):eventdate.getHours()<10?(eventrange="morning",nexteventrange="afternoon"):eventdate.getHours()<17?(eventrange="afternoon",nexteventrange="evening"):eventdate.getHours()<22?(eventrange="evening",nexteventrange="night"):(eventrange="night",nexteventrange="endday"),$("#calendar_wrapper #appointment_list #"+eventrange).css("display","block"),$("#appointment_list #"+nexteventrange).before("All day"!=eventlength?'<div id="'+events[t].id+'"class="aptlst"><div id="time">'+events[t].start.slice(-5)+" - "+eventlength+"</div>"+events[t].title+'<div id="delete"><img src="img/trash.svg"></div></div>':'<div id="'+events[t].id+'"class="aptlst"><div style="height:0.35em"></div>'+events[t].title+'<div style="height:0.3em"></div><div id="delete"><img src="img/trash.svg"></div></div>'),t++,void 0!=events[t]););}}function b(){y?(k(0,events,isaa),y=!y):($("#views #time").remove(),$("#views #container > div").remove(),H(cm,cy))}function D(e){state="detail_"+e,$.each(events,function(t,i){return i.id==e?($("#detail #title").val(i.title),$("#detail #status img").css({width:"0px"}),"Free"==i.status?$("#detail #status img#free").css({width:"3%"}):"Busy"==i.status?$("#detail #status img#busy").css({width:"3%"}):$("#detail #status img#tentative").css({width:"3%"}),tmpeventstartdate=new Date(new Date(i.start+"Z").getTime()-36e5*currentTimezone),tmpeventenddate=new Date(new Date(i.end+"Z").getTime()-36e5*currentTimezone),$("#detail #time #text #startdatey").val(tmpeventstartdate.getFullYear()),$("#detail #time #text #startdatem").val(("0"+(tmpeventstartdate.getMonth()+1)).slice(-2)),$("#detail #time #text #startdated").val(("0"+tmpeventstartdate.getDate()).slice(-2)),$("#detail #time #text #starttimeh").val(("0"+tmpeventstartdate.getHours()).slice(-2)),$("#detail #time #text #starttimem").val(("0"+tmpeventstartdate.getMinutes()).slice(-2)),$("#detail #time #text #enddatey").val(tmpeventenddate.getFullYear()),$("#detail #time #text #enddatem").val(("0"+(tmpeventenddate.getMonth()+1)).slice(-2)),$("#detail #time #text #enddated").val(("0"+tmpeventenddate.getDate()).slice(-2)),$("#detail #time #text #endtimeh").val(("0"+tmpeventenddate.getHours()).slice(-2)),$("#detail #time #text #endtimem").val(("0"+tmpeventenddate.getMinutes()).slice(-2)),$("#detail #location #text #locin").val(i.location),$("#detail #organizer #text #orgin").val(i.organizer),$("#detail #organizer #text #website").val(i.webpage),$("#detailimg").css("background-image","url("+(""==i.imageurl?"img/detail_standard.png":i.imageurl)+")"),!1):void 0}),3==viewstate?(goheight=$("#calendar_wrapper #appointment_list #"+e).height(),gowidth=$(window).width(),gooffsettop=$("#calendar_wrapper #appointment_list #"+e).offset().top,gooffsetleft=0):0==viewstate&&(goheight=$("#views .event-"+e).height(),gowidth=$("#views .event-"+e).width(),gooffsettop=$("#views .event-"+e).offset().top,gooffsetleft=$("#views .event-"+e).offset().left),$("#detail").css("display","block"),$("#detail").css({"margin-top":"-"+$("#detail #info").outerHeight()+"px"}),$("#detailimg").css({height:goheight+"px",width:gowidth+"px","margin-left":gooffsetleft+"px","margin-top":gooffsettop+"px",display:"block"}),setTimeout(function(){$("#detailimg").css({opacity:"1","margin-top":"0","margin-left":"0",height:"100%",width:"100%"}),setTimeout(function(){$("#detail #info #measure").css({"font-size":"1em","font-family":'"Slabo 27px", "Arial"'}),$("#detail #info #measure").html($("#detail #title").val()),$("#detail #title").width($("#detail #info #measure").width()),$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$.each($('#detail #time input[type="text"]'),function(e,t){$("#detail #info #measure").html($(t).val()),$(t).width($("#detail #info #measure").width())}),$("#detail #info #measure").html($('#detail #info #location input[type="text"]').val()),$('#detail #info #location input[type="text"]').width($("#detail #info #measure").width()),$.each($('#detail #organizer input[type="text"]'),function(e,t){$("#detail #info #measure").html(""!=$(t).val()?$(t).val():"no website"),$(t).width($("#detail #info #measure").width())}),$("#detail").css({opacity:"1","margin-top":"0px"})},300)},1)}function x(){id=state.split("_")[1],state="calendar",$("#detail").css({opacity:"0","margin-top":"-"+$("#detail #info").outerHeight()+"px"}),setTimeout(function(){$("#detailimg").css({height:goheight+"px",width:gowidth+"px","margin-left":gooffsetleft+"px","margin-top":gooffsettop+"px"}),setTimeout(function(){$("#detailimg").css("opacity","0"),setTimeout(function(){$("#detail").css("display","none"),$("#detailimg").css("display","none")},150)},150)},500)}function k(e,t,a){for(events=t,cm=a.getMonth()+1,cy=a.getFullYear(),$("#views #header #days").remove(),$("#views #header").append("<div id='days'></div>"),i=0;7>i;i++)$("#views #days").append(6!=i?"<div class='cell h'>"+M(i)+"</div>":"<div class='lastcell cell h'>"+M(i)+"</div>");viewstate=e,0==e?H(cm,cy):1==e&&(H(cm,cy),setTimeout(function(){S(fwr)},500)),v(),viewstate=3}function _(e){curmonth=e.getMonth()+1,curmonth>cm?(viewstate=0,z(1),viewstate=3):cm>curmonth&&(viewstate=0,z(-1),viewstate=3)}function z(e){$("#views #container > div").remove(),0==viewstate?(0>e&&(cm--,0==cm&&(cm=12,cy--)),e>0&&(cm++,13==cm&&(cm=1,cy++)),H(cm,cy)):1==viewstate&&(0>e?(rn--,fwr>rn&&(cm--,0==cm&&(cm=12,cy--),H(cm,cy),$("#views #container > div").remove(),rn=lwr,6!=new Date(Date.UTC(cy,cm,0)).getDay()&&rn--)):e>0&&(rn++,rn>lwr&&(rn=1,cm++,13==cm&&(cm=1,cy++))),H(cm,cy),S(rn))}function H(e,t){$("#views .head").html(I(e-1)+" "+t),C();var i,a,n,s,o,l,d,u,v,m,g,w;for(n=0,o=new Date(Date.UTC(t,e-1,1)).getDay(),e-1==0?(v=12,u=t-1,l=new Date(Date.UTC(u,v,0)).getDate()):(v=e-1,u=t,l=new Date(Date.UTC(u,v,0)).getDate()),fwr=0,0==o&&(o=7,fwr=1,n++),d=l-o+1,y=0;o-1>=y;y++)i="r0f"+y,$("#views #"+i).css("color","grey"),w=u+"-"+("0"+v).slice(-2)+"-"+("0"+d).slice(-2),$("#views #"+i).append("<div class='dates omonth' id='list-"+w+"'>"+d+"</div>"),$("#views #"+i).append("<div id='"+w+"' class='events pm'></div>"),d++;s=new Date(Date.UTC(t,e,0)),d=s.getDate();for(var y=0;d-1>=y;y++)s.setDate(y+1),a=s.getDay(),i="r"+n+"f"+a,w=t+"-"+("0"+e).slice(-2)+"-"+("0"+(y+1)).slice(-2),$("#views #"+i).append("<div class='dates' id='list-"+w+"'>"+(y+1)+"</div>"),$("#views #"+i).append("<div id='"+w+"' class='events'></div>"),lwr=n,6==a&&n++;for(td=new Date,tdid=td.getFullYear()+"-"+("0"+(td.getMonth()+1)).slice(-2)+"-"+("0"+td.getDate()).slice(-2),$("#list-"+tdid).css("background-color","#04756f"),d=1,12==e?(g=1,m=t+1):(g=e+1,m=t),6==a&&(a=-1),r=n;7>r;r++){for(f=a+1;7>f;f++)i="r"+r+"f"+f,$("#views #"+i).css("color","grey"),w=m+"-"+("0"+g).slice(-2)+"-"+("0"+d).slice(-2),$("#views #"+i).append("<div class='dates omonth' id='list-"+w+"'>"+d+"</div>"),$("#views #"+i).append("<div id='"+w+"' class='events nm'></div>"),d++;a=-1}0==viewstate&&A(),$("#views .dates").on("click",function(){id=$(this).attr("id"),id=id.slice(-10),date1=new Date(new Date(id).getTime()-3600*currentTimezone*1e3),date2=new Date,timeDiff=date1.getTime()-date2.getTime(),diffDays=Math.ceil(timeDiff/864e5),p(),listViewDay=diffDays,h(listViewDay)})}function M(e){var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t[e]}function I(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e]}function C(){for(r=0;6>r;r++)for(f=0;7>f;f++)$("#views #container").append(6==f?"<div id='new' class='lastcell cell '></div>":"<div id='new' class='cell'></div>"),$("#views #new").attr("id","r"+r+"f"+f)}function S(e){viewstate=1;var t;for(r=0;6>r;r++)for(f=0;7>f;f++)t="r"+r+"f"+f,r!=e&&$("#views #"+t).remove();var a=$("#views #container div[id]").map(function(){return this.id}).get();for(a.sort(),$("#views .cell").addClass("week"),$("#views .lastcell").addClass("week"),$("#views .dates").addClass("w"),$("#views #container").prepend("<div id='timelinecontainer' class='cell time'style='font-size:0.3em'>Time</div>"),$("#views #container").append("<div id='timeline' class='cell time'></div>"),i=0;24>i;i++){var n=("0"+i+":00").slice(-5);$("#views #timeline").append("<div class='time side'>"+n+"</div>")}for(i=0;7>i;i++)$("#views #"+a[i]).remove();for($("#views #timeline").append("<div id='eiwc'></div>"),i=0;7>i;i++)$("#views #eiwc").append("<div class='eventinweek' id='"+a[i]+"'></div>");$("#views #"+a[6]).addClass("lastday");var s=[];s[0]=I(parseInt(a[0].slice(5,7))-1),s[1]=parseInt(a[0].slice(8,10)),s[2]=a[0].slice(0,4),s[3]=I(parseInt(a[6].slice(5,7))-1),s[4]=parseInt(a[6].slice(8,10)),s[5]=a[6].slice(0,4),$("#views .head").html(s[0]+" "+s[1]+", "+s[2]+" - "+s[3]+" "+s[4]+", "+s[5]),A()}function A(){if(0==viewstate){for(i=0;i<events.length;i++)W(events[i].id,events[i].title,events[i].start,events[i].end);$(".eventinmonth").on("click",function(){rx=new RegExp("[0-9]+"),id=parseInt(rx.exec($(this).attr("class"))),D(id)})}else if(1==viewstate){for(i=0;i<events.length;i++)F(events[i].id,events[i].title,events[i].start,events[i].end,events[i].allday,events[i].imageurl);$(".eventinweek").each(function(){co=0,day=$(this).attr("id"),$("#"+day+">div").each(function(){co++,co>1&&(ec=$(this).attr("class"),$("#views #"+day+"> div").css("width","45%"),$("#views #"+day+"> div").css("float","left"),$("#views #"+day+"> ."+ec).css("margin-left","55%"))})}),$(".eventinweek > div").on("click",function(){rx=new RegExp("[0-9]+"),id=parseInt(rx.exec($(this).attr("class"))),D(id)})}}function F(e,t,i,a,n){var r=i.slice(0,10),o=parseInt(i.slice(-5,-3));o+=parseInt(i.slice(-2))/60;var l=Z(i,a);$("#views #"+r).append("<div class='event-"+e+"'></div>"),$("#views .event-"+e).append("<div class='eventtitle'>"+t+"</div>"),$("#views .event-"+e).css("position","absolute"),$("#views .event-"+e).css("z-index",e),color=g(i),$("#views .event-"+e).css("background-color",color[1]),$("#views .event-"+e).css("margin-top",Y(o)+"px"),$("#views .event-"+e).css("height",E(e,o,l,r,n,color[1]))}function W(e,t,i,a){var n=i.slice(0,10),r=(a.slice(0,10),i.slice(11,16)),o=a.slice(11,16);for(startd=new Date(i),a=new Date(a),d1=startd.getTime(),d2=a.getTime(),c=0;d2>=d1;)d=startd.getDate(),startd.setDate(d+1),d1=startd.getTime(),0==c?(line1=t,line2=r+" - 23:59"):(line1=t,line2=" All Day ",n=n.slice(0,8)+("0"+(parseInt(n.slice(-2))+1)).slice(-2)),$("#views #"+n).append("<div class='eventinmonth event-"+e+"'><div>"+line1+"</div><div>"+line2+"</div></div>"),color=g(i),$("#views .event-"+e).css("background-color",color[1]),c++;1!=c?(line1=t,line2="00:00 - "+o):"00:00"!=r||"23:59"!=o?(line1=t,line2=r+" - "+o):(line1=t,line2=" All Day "),$("#views #"+n+" .event-"+e).html("<div>"+line1+"</div><div>"+line2+"</div>")}function Y(e){var t=37,i=e*t;return i}function E(e,t,i,a,n,s){var r=35.4,l=0,d=.0166;for(pl=0;i>pl;pl+=d)l+=r*d;var c=$("#views #eiwc").height()-Y(t);return l>c?(1!=n&&O(e,l-c,a,s),c+50+"px"):l+"px"}function O(e,t,i,a){var n=parseInt(i.slice(-2)),s=parseInt(i.slice(5,7)),r=parseInt(i.slice(0,4));n++,n>new Date(r,s,0).getDate()&&(n=1,s++,(s=13)&&(s=1,r++)),n=("0"+n).slice(-2),s=("0"+s).slice(-2),i=r+"-"+s+"-"+n;var o=$("#views #eiwc").height();t>o?($("#views #"+i).append("<div id='offset-"+n+"' class='event-"+e+"'></div>"),$("#views #offset-"+n).css("height",o+50+"px"),$("#views #offset-"+n).css("background-color",a),$("#views #offset-"+n).css("border-top","none"),O(e,t-o,i,a)):($("#views #"+i).append("<div id='offset-"+n+"'></div>"),$("#views #offset-"+n).css("height",t+"px"),$("#views #offset-"+n).css("background-color",a),$("#views #offset-"+n).css("border-top","none")),oss=1}function Z(e,t){var i=new Date(e),a=new Date(t),n=a-i,s=n/1e3,r=Math.floor(s/3600),o=Math.floor(s%3600)/60;return r+o/60}$(window).load(function(){function d(e){1!=r?($(this).parent().find("img").css({width:"3%","background-color":"rgba(0,0,0,0.3)",padding:"0 0.5%"}),r=!0):($(this).parent().find("img:not(#"+e.target.id+")").css({width:"0"}),$(this).parent().find("img").css({"background-color":"transparent",padding:"0 0"}),r=e.target.id)}if(void 0==$.cookie("overview")?$.cookie("overview","true"):"false"==$.cookie("overview")&&$("#calendar_wrapper #headline #settings #content #overview").attr("src","img/checkbox_unchecked.svg"),v(),void 0==$.cookie("user"))$("#welcome h1").css("opacity","1"),setTimeout(function(){state="user",e("welcome","user",'Choose your name<br><input id="username" type="text" maxlength="10">',"#04858f"),setTimeout(function(){$("#user #username").focus()},100)},3e3);else{state="user",$("#calendar_wrapper #headline #settings #content #loggedin").attr("src","img/checkbox_checked.svg");var t=jQuery.Event("keypress");t.which=13,$(document).trigger(t)}$("#calendar_wrapper #headline #new_entry").click(function(){state="newapt1",0==viewstate||1==viewstate?(viewswerehere=!0,p()):viewswerehere=!1,n(),a("name",'What\'s going on?*<br><input id="aptname" type="text"><br><span style="font-size:0.5em">*required</span>',"#024d25"),$("#aptname").focus()}),$("#close_fullscreen").click(function(){viewswerehere&&p(),n()}),$("#calendar_wrapper #day #next").click(function(){$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","0"),setTimeout(function(){listViewDay++,h(listViewDay),$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","1")},500)}),$("#calendar_wrapper #day #back").click(function(){$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","0"),setTimeout(function(){listViewDay--,h(listViewDay),$("#calendar_wrapper #appointment_list, #calendar_wrapper #day #current").css("opacity","1")},500)}),$("#detail #info #close").click(function(){x()}),$("#calendar_wrapper #headline #settings > img").click(function(){s()}),$("#calendar_wrapper #headline #settings #content #overview").click(function(){o()}),$("#calendar_wrapper #headline #settings #content #loggedin").click(function(){l()}),$("#calendar_wrapper #headline #toggle_view").click(function(){p()}),$(document).on("click","#calendar_wrapper #appointment_list .aptlst #delete",function(e){e.stopPropagation(),$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"delete",format:"json",id:$(this).parent().attr("id")},function(e){void 0!=e.error?u("Error","The element could not be deleted. The error is<br>#"+e.error.id+": "+e.error.text,4e3,"error"):w(function(){u("Deleted","The element was successfully deleted.",4e3,"success")})})}),$(document).on("click","#calendar_wrapper #appointment_list .aptlst",function(){D($(this).attr("id"))}),$(document).on("mouseover","#calendar_wrapper #appointment_list .aptlst #delete",function(){$(this).find("img").attr("src","img/trash_hover.svg")}),$(document).on("mouseout","#calendar_wrapper #appointment_list .aptlst #delete",function(){$(this).find("img").attr("src","img/trash.svg")}),$(document).on("mouseover","#calendar_wrapper #appointment_list .aptlst",function(){$(this).find("#delete").css("opacity","1"),$(this).find("#time").css("color","#000000")}),$(document).on("mouseout","#calendar_wrapper #appointment_list .aptlst",function(){$(this).find("#delete").css("opacity","0"),$(this).find("#time").css("color","#bbbbbb")});var i=!1;$("#detail #info #edit").click(function(){i?($(this).css({transform:"rotate(-360deg) scale(0)","background-color":"transparent"}),setTimeout(function(){$("#detail #info #edit img").attr("src","img/edit.svg"),$("#detail #info #edit").css({transform:"rotate(0deg) scale(1)"})},250),$('#detail #info input[type="text"]').attr("disabled","true"),(0!=r||void 0!=r)&&$("#detail #info #status").click(),$("#detail #info #status img").off("click"),$("#detail #info #status img").css({cursor:"auto"}),editstart=$("#detail #info #startdatey").val()+"-"+$("#detail #info #startdatem").val()+"-"+$("#detail #info #startdated").val()+"T"+$("#detail #info #starttimeh").val()+":"+$("#detail #info #starttimem").val(),editend=$("#detail #info #enddatey").val()+"-"+$("#detail #info #enddatem").val()+"-"+$("#detail #info #enddated").val()+"T"+$("#detail #info #endtimeh").val()+":"+$("#detail #info #endtimem").val(),editstart=new Date(new Date(editstart+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),editend=new Date(new Date(editend+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"update",format:"json",id:state.split("_")[1],title:$("#detail #info #title").val(),location:$("#detail #info #locin").val(),organizer:$("#detail #info #orgin").val(),start:editstart,end:editend,status:r.substr(0,1).toUpperCase()+r.substr(1),allday:0,webpage:$("#detail #info #website").val()},function(e){void 0!=e.error?(u("No edit today<br>my app has broke away","Dang it!<br>#"+e.error.id+" with message<br>"+e.error.text+"<br>has occured.",7500,"error"),D(state.split("_")[1])):u("Edit successful",$("#detail #info #title").val()+" was edited.",3500,"success"),w()})):(u("Edit enabled","Just click on the entries you want to edit.<br>Afterwards, click on the save icon.",3500),$(this).css({transform:"rotate(-360deg) scale(0)"}),setTimeout(function(){$("#detail #info #edit img").attr("src","img/save.svg"),$("#detail #info #edit").css({transform:"rotate(-720deg) scale(1)","background-color":"rgba(0,0,0,0.3)"})},250),$.each($("#detail #info #status img"),function(e,t){"0px"!=$(t).css("width")&&(r=$(t).attr("id"))}),$('#detail #info input[type="text"]').removeAttr("disabled"),$("#detail #info #status img").click(d),$("#detail #info #status img").css({cursor:"pointer"})),i=!i}),$("#detail #info #title").focusin(function(){$(this).css({width:"90%","background-color":"rgba(0,0,0,0.3)"})}),$("#detail #info #title").focusout(function(){$("#detail #info #measure").css({"font-size":"1em","font-family":'"Slabo 27px", "Arial"'}),$("#detail #info #measure").html($("#detail #title").val()),$(this).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})}),$.each($('#detail #info #time input[type="text"]'),function(e,t){$(t).focusin(function(){$(this).css({width:"7.5%","background-color":"rgba(0,0,0,0.3)"})}),$(t).focusout(function(){$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$("#detail #info #measure").html($(this).val()),$(this).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})})}),$.each($('#detail #info #location input[type="text"]'),function(e,t){$(t).focusin(function(){$(t).css({width:"90%","background-color":"rgba(0,0,0,0.3)"})}),$(t).focusout(function(){$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$("#detail #info #measure").html($(t).val()),$(t).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})})}),$.each($('#detail #info #organizer input[type="text"]'),function(e,t){$(t).focusin(function(){$(t).css({width:"45%","background-color":"rgba(0,0,0,0.3)"})}),$(t).focusout(function(){$("#detail #info #measure").css({"font-size":"0.5em","font-family":'"PT Sans", "Arial"'}),$("#detail #info #measure").html(""!=$(t).val()?$(t).val():"no website"),$(t).css({width:$("#detail #info #measure").width(),"background-color":"transparent"})})});var r=!0}),$(window).resize(function(){v()});var m="";$(document).keypress(function(a){if(13==a.which)if("user"==state){void 0==$.cookie("user")?(e("user","userloading",'<img src="img/loading.svg" style="height:100px; width:100px">',"#04959f"),user=$("#user #username").val()):(e("welcome","userloading",'<img src="img/loading.svg" style="height:100px; width:100px">',"#04959f"),user=$.cookie("user")),state="calendarlist";var s=[],r=[],o=[];w(function(){if(i=0,tmpdate=(new Date).getTime(),void 0!=events[i])for(;new Date(events[i].start).getTime()<tmpdate&&(i++,void 0!=events[i]););for(j=0;3>j;j++){if(void 0!=events[i])s[j]=events[i].title,r[j]=events[i].start.split("T")[1],o[j]=g(events[i].start);else{if(0==j){s[0]="This is where your day is shown and you have a quick look",r[0]="it",o[0]=["","#024d25"],s[1]="The colors indicate the daytime. This would be",r[1]="night",o[1]=["","#010f47"],s[2]="and enjoy making appointments",r[2]="this place",o[2]=["So welcome -","#d90000"];break}1==j?(s[j]="You're free",r[j]="this time",o[j]=["Enjoy!","#024d25"]):2==j&&(s[j]="Nothing more",r[j]="the moment",o[j]=["Free Time!","#024d25"])}i++}greeting=0==currentDaytime?"Have a good night,":1==currentDaytime?"Good morning,":2==currentDaytime?"Hello":"Good evening,",e("userloading","hello",greeting+" "+user+"!","#04959f"),"true"==$.cookie("overview")?setTimeout(function(){t("hello",25,75,"#04756f",o[0][1]),setTimeout(function(){e("hello","nextaptmnt",o[0][0]+" "+s[0]+" at "+r[0]+".",o[0][1])},1100),setTimeout(function(){t("nextaptmnt",25,50,o[0][1],o[1][1]),setTimeout(function(){e("nextaptmnt","2ndaptmnt",o[1][0]+" "+s[1]+" at "+r[1]+".",o[1][1]),setTimeout(function(){t("2ndaptmnt",25,25,o[1][1],o[2][1]),setTimeout(function(){e("2ndaptmnt","3rdaptmnt",o[2][0]+" "+s[2]+" at "+r[2]+".",o[2][1]),setTimeout(function(){n(),setTimeout(function(){$("#close_fullscreen").css("display","block")},1e3)},2400)},1100)},2400)},1100)},3500)},2e3):setTimeout(function(){n(),setTimeout(function(){$("#close_fullscreen").css("display","block")},1e3)},2e3)})}else if("newapt1"==state)state="newapt2",e("name","place",'Where do you go?*<br><input id="aptplace" type="text">',"#024d25"),$("#aptplace").focus();else if("newapt2"==state)state="newapt3",e("place","corganizer",'Who planned this?*<br><input id="aptorganizer" type="text" placeholder="Mail Address">',"#024d25"),$("#aptorganizer").focus();else if("newapt3"==state)state="newapt4",e("corganizer","start",'When do you go?*<br><input id="aptyear" type="text" maxlength="4" placeholder="YYYY" style="width:15%"><input id="aptmonth" type="text" maxlength="2" placeholder="MM" style="width:7.5%; margin:0 0.5%"><input id="aptday" type="text" maxlength="2" placeholder="DD" style="width:7.5%"><br><input id="apthour" type="text" maxlength="2" placeholder="HH" style="width:7.5%">:<input id="aptminute" type="text" maxlength="2" placeholder="MM" style="width:7.5%">',"#024d25"),$("#aptyear").focus();else if("newapt4"==state)state="newapt5",e("start","end",'How long is this event?*<br><input id="aptlhour" type="text" style="margin-bottom:2%; width:10%">h<input id="aptlminutes" type="text" style="margin-bottom:2%; width:10%">min '+currTimezString+'<br><a href="javascript:void(0)" id="aptallday">All Day</a>',"#024d25"),aptallday=!1,$("#aptallday").click(function(){aptallday=!0;var e=jQuery.Event("keypress");e.which=13,$(document).trigger(e)}),$("#aptlhour").focus();else if("newapt5"==state)state="newapt6",e("end","status",'Are you available whilst this?*<br><a href="javascript:void(0)" id="aptfree">Free</a><a href="javascript:void(0)" id="aptbusy">Busy</a><a href="javascript:void(0)" id="apttent">Tentative</a>',"#024d25"),$("#aptfree").click(function(){m="Free",state="newapt7",e("status","webpage",'Is there a website?<br><input id="aptwebsite" type="text"><br><span style="font-size:0.5em">Enter to skip</span>',"#024d25"),$("#aptwebsite").focus()}),$("#aptbusy").click(function(){m="Busy",state="newapt7",e("status","webpage",'Is there a website?<br><input id="aptwebsite" type="text"><br><span style="font-size:0.5em">Enter to skip</span>',"#024d25"),$("#aptwebsite").focus()}),$("#apttent").click(function(){m="Tentative",state="newapt7",e("status","webpage",'Is there a website?<br><input id="aptwebsite" type="text"><br><span style="font-size:0.5em">Enter to skip</span>',"#024d25"),$("#aptwebsite").focus()});else if("newapt7"==state)state="newapt8",e("webpage","image",'Do you want to attach an image?<br><a href="javascript:void(0)" id="aptimgsel">Choose Image</a><input id="aptimage" type="file" accept="image/jpeg, image/png" style="display:none;"><br><span style="font-size:0.5em">Enter to skip or continue</span>',"#024d25"),$("#aptimgsel").click(function(){$("#aptimage").click(),$("#aptimgsel").blur()});else if("newapt8"==state){aptallday?(aptstart=$("#aptyear").val()+"-"+$("#aptmonth").val()+"-"+$("#aptday").val()+"T00:00",aptend=$("#aptyear").val()+"-"+$("#aptmonth").val()+"-"+$("#aptday").val()+"T23:59",aptalldaynum="1"):(enddate=new Date(parseInt($("#aptyear").val()),parseInt($("#aptmonth").val()-1),parseInt($("#aptday").val()),parseInt($("#apthour").val())+parseInt($("#aptlhour").val()),parseInt($("#aptminute").val())+parseInt($("#aptlminutes").val()),0,0),aptstart=$("#aptyear").val()+"-"+$("#aptmonth").val()+"-"+$("#aptday").val()+"T"+$("#apthour").val()+":"+$("#aptminute").val(),aptend=enddate.getFullYear()+"-"+("0"+(enddate.getMonth()+1)).slice(-2)+"-"+("0"+enddate.getDate()).slice(-2)+"T"+("0"+enddate.getHours()).slice(-2)+":"+("0"+enddate.getMinutes()).slice(-2),aptalldaynum="0");
try{aptstart=new Date(new Date(aptstart+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),aptend=new Date(new Date(aptend+"Z").getTime()+36e5*currentTimezone*-1).toISOString().substr(0,16),timeerror=!1}catch(a){timeerror=!0}$.post("http://host.bisswanger.com/dhbw/calendar.php",{user:user,action:"add",format:"json",title:$("#aptname").val(),location:$("#aptplace").val(),organizer:$("#aptorganizer").val(),start:aptstart,end:aptend,status:m,allday:0,webpage:$("#aptwebsite").val()},function(t){function a(){state="newaptsummary",tmpname=$("#aptname").val().length<23?$("#aptname").val():$("#aptname").val().slice(0,20)+"...",$("#close_fullscreen").css("opacity","0"),e("image","sumloading",'<img src="img/loading.svg" style="height:100px; width:100px">',"#024d25"),w(function(){aptallday?e("sumloading","summary","Your appointment has been saved!<br>"+tmpname+"<br>All day on "+$("#aptyear").val()+"/"+$("#aptmonth").val()+"/"+$("#aptday").val()+"!","#024d25"):e("sumloading","summary","Your appointment has been saved!<br>"+tmpname+"<br>On "+$("#aptyear").val()+"/"+$("#aptmonth").val()+"/"+$("#aptday").val()+" at "+$("#apthour").val()+":"+$("#aptminute").val()+"!","#024d25"),setTimeout(function(){state="calendar",$("#close_fullscreen").css("opacity","1"),n()},4e3)})}void 0!=t.error||1==timeerror?e("image","summary","Oh Snap!<br>#"+t.error.id+": "+t.error.text+'<br>Please contact <a href="http://twitter.com/4dialects">us</a> about this error so we can fix it!',"#8f0000"):void 0!=document.getElementById("aptimage").files[0]?(fd=new FormData,fd.append("user",user),fd.append("action","upload-image"),fd.append("format","json"),fd.append("id",t.add.id),fd.append("file",document.getElementById("aptimage").files[0]),$.ajax({url:"http://host.bisswanger.com/dhbw/calendar.php",type:"POST",processData:!1,contentType:!1,data:fd,success:function(t){void 0!=t.error?(e("image","summary","Your appoinment has been saved but:<br>No picture for you today!<br>#"+t.error.id+": "+t.error.text+'<br>Please contact <a href="http://twitter.com/4dialects">us</a> about this error so we can fix it!',"#ff8c00"),w()):a()}})):a()})}});var y=!0;$("#views #back").click(function(){z(-1)}),$("#views #forward").click(function(){z(1)}),$("#views #weekview").click(function(){0==viewstate&&($("#views #days").prepend("<div class='time' id='time' style='float:left'>&nbsp;</div>"),S(fwr),viewstate=1)}),$("#views #monthview").click(function(){1==viewstate&&($("#views #time").remove(),$("#views #container > div").remove(),viewstate=0,H(cm,cy))}),$(document).keydown(function(e){3!=viewstate&&(37==e.keyCode?z(-1):39==e.keyCode?z(1):27==e.keyCode&&($("#views #time").remove(),$("#views #container > div").remove(),viewstate=0,H(cm,cy)))})});
>>>>>>> origin/master
